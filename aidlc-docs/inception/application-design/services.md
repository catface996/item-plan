# 服务定义 - 商品审核模块

## 业务服务概览

| 服务 | 职责 | 依赖 |
|------|------|------|
| ProductService | 商品生命周期管理 | ProductMapper, AuditService |
| AuditService | 审核流程管理 | AuditMapper, ProductMapper |
| UserService | 用户认证授权 | UserMapper |

---

## 服务详细定义

### 1. ProductService

**职责**: 管理商品的创建、查询、更新和状态变更

**核心功能**:
- 商品信息CRUD
- 商品状态管理
- 商家商品列表查询

**服务编排**:
```
商品创建流程:
1. 验证商品数据
2. 保存商品信息
3. 设置初始状态为"待审核"
4. 返回创建结果

商品重新提交流程:
1. 验证商品状态为"需修改"
2. 更新商品信息
3. 重置状态为"待审核"
4. 记录操作日志
```

### 2. AuditService

**职责**: 管理审核流程、记录审核历史

**核心功能**:
- 待审核/待复审列表查询
- 审核操作执行
- 审核历史记录
- 审核统计报表

**服务编排**:
```
初审流程:
1. 验证审核员权限（普通审核员）
2. 验证商品状态为"待审核"
3. 执行审核操作（通过/拒绝/需修改）
4. 更新商品状态
5. 创建审核记录
6. 返回操作结果

复审流程:
1. 验证审核员权限（高级审核员）
2. 验证商品状态为"初审通过"
3. 执行审核操作（通过/拒绝/需修改）
4. 更新商品状态
5. 创建审核记录
6. 返回操作结果
```

### 3. UserService

**职责**: 用户认证、授权和会话管理

**核心功能**:
- 用户登录/登出
- 会话管理
- 权限验证

**服务编排**:
```
登录流程:
1. 验证用户名密码
2. 生成JWT Token
3. 返回用户信息和Token

权限验证流程:
1. 解析JWT Token
2. 获取用户角色
3. 验证角色权限
4. 返回验证结果
```

---

## 服务交互流程

### 商品提交到审核完成的完整流程

```
┌─────────┐     ┌─────────────────┐     ┌──────────────┐
│  商家   │────▶│ ProductService  │────▶│ ProductMapper│
└─────────┘     └─────────────────┘     └──────────────┘
                        │
                        ▼ 状态: 待审核
┌─────────┐     ┌─────────────────┐     ┌──────────────┐
│普通审核员│────▶│  AuditService   │────▶│ AuditMapper  │
└─────────┘     └─────────────────┘     └──────────────┘
                        │
                        ▼ 状态: 初审通过
┌─────────┐     ┌─────────────────┐     ┌──────────────┐
│高级审核员│────▶│  AuditService   │────▶│ AuditMapper  │
└─────────┘     └─────────────────┘     └──────────────┘
                        │
                        ▼ 状态: 通过/拒绝
```

### 认证授权流程

```
┌─────────┐     ┌─────────────────┐     ┌──────────────┐
│  用户   │────▶│   AuthFilter    │────▶│ UserService  │
└─────────┘     └─────────────────┘     └──────────────┘
                        │
                        ▼ Token验证
                ┌─────────────────┐
                │ 业务Controller  │
                └─────────────────┘
```
